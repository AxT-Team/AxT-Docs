---
title: ğŸ”Œ åˆ›å»ºç¬¬ä¸€ä¸ªæ’ä»¶
date: 2025-08-28 18:56:29
permalink: /axtbot/v2.1/develop/create-a-plugin
author:
  name: AxT-Team - Shanshui2024
  link: https://github.com/Shanshui2024
---

# åˆ›å»ºç¬¬ä¸€ä¸ªæ’ä»¶
æ‰“å¼€ä½ çš„æ’ä»¶ç›®å½• åˆ›å»ºä¸€ä¸ªpyæ–‡ä»¶ åç§°éšæ„ ä»¥ä¸‹æ–‡æ¡£ç§°åˆ›å»ºçš„æ’ä»¶ä¸º `example.py`

æ‰“å¼€æ–‡ä»¶ ç„¶åå¡«å…¥ä¸‹é¢è¿™ä¸€è¡Œ
``` python
__metadata__ = {
    "name": "æ’ä»¶åç§°",
    "version": "1.0.0",
    "author": "ä½œè€…å",
    "description": "è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ’ä»¶"
}
```
è¿™å››ä¸ªéƒ½å¯ä»¥è‡ªè¡Œä¿®æ”¹

è¿™æ · æˆ‘ä»¬å°±å®Œæˆäº†æ’ä»¶çš„å¼€å‘~

## åˆ›å»ºæ’ä»¶åŠŸèƒ½
ä¸Šæ–‡ä¸­ æˆ‘ä»¬æåˆ°äº†ä¸€ä¸ª`__metadata__`å­—æ®µ é‚£ä¹ˆè¿™åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

è®©æˆ‘ä»¬å›åˆ°æ¡†æ¶å¤„ç†é€»è¾‘ä¸Š

æ¡†æ¶åœ¨å¯åŠ¨æ—¶ ä¼šè¯»å–æ’ä»¶çš„`__metadata__`å­—æ®µ å¹¶è·å–è¯¥æ’ä»¶çš„ä¿¡æ¯ æä¾›è¯¥æ¥å£ä»¥æ–¹ä¾¿å…¶ä»–æ’ä»¶è¿›è¡Œç®¡ç†ç­‰

è¿™æ · æˆ‘ä»¬çš„æ’ä»¶å¸‚åœºä¹Ÿå¯ä»¥æ ¹æ®ä¸Šé¢çš„å†…å®¹è¿›è¡Œå†…å®¹æ„å»º

é‚£ä¹ˆ è¦åšæˆä¸€ä¸ªæ’ä»¶ æˆ‘ä»¬å°±éœ€è¦è®©ä»–èƒ½å…ˆæ¥æ”¶åˆ°æ¶ˆæ¯

æ¯”å¦‚ï¼šæˆ‘è¦å¼€å‘ä¸€ä¸ªå¤©æ°”æ’ä»¶ é‚£ä¹ˆ æˆ‘ä»¬å¯ä»¥å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š

``` python
from src.Utils.PluginBase import command
from src.Utils.EventClass import GroupMessageEvent # æ³¨æ„ï¼šæ­¤å¤„ä»…å¯¼å…¥ç¾¤æ¶ˆæ¯äº‹ä»¶ï¼Œå®é™…è¿˜æœ‰å…¶ä»–çš„ï¼Œæˆ‘ä»¬æ—¥åå†è¯´

...
# ä¸Šæ–‡çš„metadataå­—æ®µå·²çœç•¥

@command(["/æŸ¥å¤©æ°”","æŸ¥å¤©æ°”"])
async def handler_function(event: GroupMessageEvent):
    await event.reply("æ­£åœ¨æŸ¥è¯¢å¤©æ°”...")
```

è¿™æ ·ï¼Œå½“æˆ‘ä»¬å¡å…¥ `plugins` æ–‡ä»¶å¤¹ã€é‡å¯æ¡†æ¶ï¼Œç„¶åè‰¾ç‰¹æœºå™¨äººï¼Œå°±ä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼š

```
ç”¨æˆ·ï¼š@æœºå™¨äºº /æŸ¥å¤©æ°”

æœºå™¨äººï¼šæ­£åœ¨æŸ¥è¯¢å¤©æ°”...
```

æ­å–œï¼æˆ‘ä»¬å·²ç»å­¦ä¼šäº†æœ€åŸºç¡€çš„äº‹ä»¶æ¥å—ã€å‘½ä»¤æ³¨å†Œå’Œæ¶ˆæ¯å›å¤ï¼

## ç»†èŠ‚çš„äº‹ä»¶å¤„ç†
ä½†æ˜¯ï¼Œä½œä¸ºä¸€ä¸ªæŸ¥è¯¢å¤©æ°”çš„æœºå™¨äººè€Œè¨€ï¼Œå…‰å›å¤ä¸€ä¸ªæŸ¥è¯¢å¤©æ°”è‚¯å®šä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„

é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨å›å¤ä¹‹åè¿›è¡Œæ¶ˆæ¯çš„æ£€æŸ¥ã€ä»£å…¥APIè¿›è¡Œè¯·æ±‚ä¹‹ç±»çš„

æ€ä¹ˆåšå‘¢ï¼Ÿæˆ‘ä»¬åœ¨æ–‡ä»¶ä¸­å¡«å…¥ä»¥ä¸‹å‡ è¡Œï¼š

``` python
from src.Utils.PluginBase import command
from src.Utils.EventClass import GroupMessageEvent

...
# ä¸Šæ–‡çš„metadataå­—æ®µå·²çœç•¥

@command(["/æŸ¥å¤©æ°”","æŸ¥å¤©æ°”"])
async def handler_function(event: GroupMessageEvent):
    await event.reply("æ­£åœ¨æŸ¥è¯¢å¤©æ°”...") # [!code --]
    msg = event.content # [!code ++]
    msg = msg.split(" ")[1] # [!code ++]
    if msg: # [!code ++]
        await event.reply(f"æ‚¨è¦æŸ¥è¯¢çš„åŸå¸‚ä¸ºï¼š{msg}")  # [!code ++]
    else: # [!code ++]
        await event.reply("è¯·é™„å¸¦è¦æŸ¥è¯¢çš„åŸå¸‚") # [!code ++]
```

okï¼Œæ­¤æ—¶é‡å¯æ¡†æ¶ï¼Œå°±ä¼šåœ¨å‘èµ·å‘½ä»¤åæ˜¾ç¤º `æ‚¨è¦æŸ¥è¯¢çš„åŸå¸‚ä¸ºï¼šxxx`

---

æœ¬ä¾‹ä¸­ æˆ‘ä»¬å¯ä»¥åœ¨ä»£ç æ®µä¸­çœ‹åˆ°ä¸€ä¸ª `event.content` å­—æ®µ

äº‹å®ä¸Šï¼Œè¿™ä¸ªå­—æ®µå’Œå…¶ä»–å­—æ®µï¼ˆä¾‹å¦‚ `event.user_id` ï¼‰éƒ½æ˜¯ã€Œ**æ¶ˆæ¯äº‹ä»¶**ã€æ‰€å…·æœ‰çš„

å¯¹äºä¸åŒçš„æ¶ˆæ¯ä½“ï¼Œæˆ‘ä»¬æœ‰ä¸åŒçš„å­—æ®µï¼Œæ¯”å¦‚ç¾¤èŠå°±ä¼šæœ‰ç¾¤èŠOpenIDï¼Œé¢‘é“å°±ä¼šæœ‰channel_idå’Œguild_idç­‰

ä¸è¿‡ç›®å‰æˆ‘ä»¬å°±å…ˆä½¿ç”¨é€šç”¨çš„ `event.content` å­—æ®µ è·å–åˆ°å½“å‰çš„æ¶ˆæ¯ä¸²

ç„¶å å†æŠŠ `msg` å­—ç¬¦ä¸²è¿›è¡Œåˆ†æï¼Œæˆ–æ˜¯ç›´æ¥å¡«å…¥APIæ¥å£é‡Œè¿›è¡Œæ£€ç´¢ã€‚è¿™é‡Œä»¥ ã€Œ[Uapis.cn](https://uapis.cn/)ã€ çš„ã€[å¤©æ°”æŸ¥è¯¢æ¥å£](https://uapis.cn/docs/api-reference/get-misc-weather)ã€ä¸ºä¾‹ï¼Œå³ï¼š

``` python
import requests # å¼•å…¥requestsè¯·æ±‚æ¨¡å—  [!code ++]
from src.Utils.PluginBase import command
from src.Utils.EventClass import GroupMessageEvent

...
# ä¸Šæ–‡çš„é€»è¾‘ä»£ç å·²çœç•¥
    if msg:
        await event.reply(f"æ‚¨è¦æŸ¥è¯¢çš„åŸå¸‚ä¸ºï¼š{msg}")
        url = f"https://uapis.cn/api/v1/misc/weather?city={msg}"# [!code ++]
        response = requests.get(url)# [!code ++]
        data = response.json()# [!code ++]
        if response.status_code == 200:# [!code ++]
            await event.reply(f"{data['city']}å¤©æ°”æƒ…å†µï¼š{data['weather']}")# [!code ++]
    else:
        await event.reply("è¯·é™„å¸¦è¦æŸ¥è¯¢çš„åŸå¸‚")
```

æ­¤æ—¶ï¼Œå†æ¬¡é‡å¯ï¼Œæˆ‘ä»¬å°±ä¼šå¾—åˆ°ï¼š
```
ç”¨æˆ·ï¼š@æœºå™¨äºº /æŸ¥å¤©æ°” åŒ—äº¬

æœºå™¨äººï¼šæ‚¨è¦æŸ¥è¯¢çš„åŸå¸‚ä¸ºï¼šåŒ—äº¬

æœºå™¨äººï¼šåŒ—äº¬å¤©æ°”æƒ…å†µï¼šé˜´
```

è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ä¸€ä¸ªç®€å•çš„äº‹ä»¶å¤„ç†é€»è¾‘ã€‚

## å®ç°
å®é™…ä¸Šï¼Œåƒè¿™æ ·çš„æ¡†æ¶å†…éƒ¨é€»è¾‘æœ‰å¾ˆå¤šï¼Œè¿™äº›å®ç° ä¾‹å¦‚ `event` å­—æ®µ éƒ½ä¼šåœ¨åæ–‡æåˆ°å…·ä½“çš„å­—æ®µ `attributes`